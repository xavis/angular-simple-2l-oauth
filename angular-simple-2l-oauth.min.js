function hex_sha1(r){return binb2hex(core_sha1(str2binb(r),r.length*chrsz))}function b64_sha1(r){return binb2b64(core_sha1(str2binb(r),r.length*chrsz))}function str_sha1(r){return binb2str(core_sha1(str2binb(r),r.length*chrsz))}function hex_hmac_sha1(r,a){return binb2hex(core_hmac_sha1(r,a))}function b64_hmac_sha1(r,a){return binb2b64(core_hmac_sha1(r,a))}function str_hmac_sha1(r,a){return binb2str(core_hmac_sha1(r,a))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(r,a){r[a>>5]|=128<<24-a%32,r[(a+64>>9<<4)+15]=a;for(var n=Array(80),t=1732584193,h=-271733879,e=-1732584194,c=271733878,s=-1009589776,o=0;o<r.length;o+=16){for(var b=t,_=h,f=e,u=c,i=s,d=0;80>d;d++){n[d]=16>d?r[o+d]:rol(n[d-3]^n[d-8]^n[d-14]^n[d-16],1);var l=safe_add(safe_add(rol(t,5),sha1_ft(d,h,e,c)),safe_add(safe_add(s,n[d]),sha1_kt(d)));s=c,c=e,e=rol(h,30),h=t,t=l}t=safe_add(t,b),h=safe_add(h,_),e=safe_add(e,f),c=safe_add(c,u),s=safe_add(s,i)}return Array(t,h,e,c,s)}function sha1_ft(r,a,n,t){return 20>r?a&n|~a&t:40>r?a^n^t:60>r?a&n|a&t|n&t:a^n^t}function sha1_kt(r){return 20>r?1518500249:40>r?1859775393:60>r?-1894007588:-899497514}function core_hmac_sha1(r,a){var n=str2binb(r);n.length>16&&(n=core_sha1(n,r.length*chrsz));for(var t=Array(16),h=Array(16),e=0;16>e;e++)t[e]=909522486^n[e],h[e]=1549556828^n[e];var c=core_sha1(t.concat(str2binb(a)),512+a.length*chrsz);return core_sha1(h.concat(c),672)}function safe_add(r,a){var n=(65535&r)+(65535&a),t=(r>>16)+(a>>16)+(n>>16);return t<<16|65535&n}function rol(r,a){return r<<a|r>>>32-a}function str2binb(r){for(var a=Array(),n=(1<<chrsz)-1,t=0;t<r.length*chrsz;t+=chrsz)a[t>>5]|=(r.charCodeAt(t/chrsz)&n)<<32-chrsz-t%32;return a}function binb2str(r){for(var a="",n=(1<<chrsz)-1,t=0;t<32*r.length;t+=chrsz)a+=String.fromCharCode(r[t>>5]>>>32-chrsz-t%32&n);return a}function binb2hex(r){for(var a=hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",t=0;t<4*r.length;t++)n+=a.charAt(r[t>>2]>>8*(3-t%4)+4&15)+a.charAt(r[t>>2]>>8*(3-t%4)&15);return n}function binb2b64(r){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",t=0;t<4*r.length;t+=3)for(var h=(r[t>>2]>>8*(3-t%4)&255)<<16|(r[t+1>>2]>>8*(3-(t+1)%4)&255)<<8|r[t+2>>2]>>8*(3-(t+2)%4)&255,e=0;4>e;e++)n+=8*t+6*e>32*r.length?b64pad:a.charAt(h>>6*(3-e)&63);return n}var hexcase=0,b64pad="",chrsz=8;
var OAuth;null==OAuth&&(OAuth={}),OAuth.setProperties=function(e,t){if(null!=e&&null!=t)for(var r in t)e[r]=t[r];return e},OAuth.setProperties(OAuth,{percentEncode:function(e){if(null==e)return"";if(e instanceof Array){for(var t="",r=0;r<e.length;++e)""!=t&&(t+="&"),t+=OAuth.percentEncode(e[r]);return t}return e=encodeURIComponent(e),e=e.replace(/\!/g,"%21"),e=e.replace(/\*/g,"%2A"),e=e.replace(/\'/g,"%27"),e=e.replace(/\(/g,"%28"),e=e.replace(/\)/g,"%29")},decodePercent:function(e){return null!=e&&(e=e.replace(/\+/g," ")),decodeURIComponent(e)},getParameterList:function(e){if(null==e)return[];if("object"!=typeof e)return OAuth.decodeForm(e+"");if(e instanceof Array)return e;var t=[];for(var r in e)t.push([r,e[r]]);return t},getParameterMap:function(e){if(null==e)return{};if("object"!=typeof e)return OAuth.getParameterMap(OAuth.decodeForm(e+""));if(e instanceof Array){for(var t={},r=0;r<e.length;++r){var n=e[r][0];void 0===t[n]&&(t[n]=e[r][1])}return t}return e},getParameter:function(e,t){if(!(e instanceof Array))return OAuth.getParameterMap(e)[t];for(var r=0;r<e.length;++r)if(e[r][0]==t)return e[r][1];return null},formEncode:function(e){for(var t="",r=OAuth.getParameterList(e),n=0;n<r.length;++n){var a=r[n][1];null==a&&(a=""),""!=t&&(t+="&"),t+=OAuth.percentEncode(r[n][0])+"="+OAuth.percentEncode(a)}return t},decodeForm:function(e){for(var t=[],r=e.split("&"),n=0;n<r.length;++n){var a=r[n];if(""!=a){var u,o,i=a.indexOf("=");0>i?(u=OAuth.decodePercent(a),o=null):(u=OAuth.decodePercent(a.substring(0,i)),o=OAuth.decodePercent(a.substring(i+1))),t.push([u,o])}}return t},setParameter:function(e,t,r){var n=e.parameters;if(n instanceof Array){for(var a=0;a<n.length;++a)n[a][0]==t&&(void 0===r?n.splice(a,1):(n[a][1]=r,r=void 0));void 0!==r&&n.push([t,r])}else n=OAuth.getParameterMap(n),n[t]=r,e.parameters=n},setParameters:function(e,t){for(var r=OAuth.getParameterList(t),n=0;n<r.length;++n)OAuth.setParameter(e,r[n][0],r[n][1])},completeRequest:function(e,t){null==e.method&&(e.method="GET");var r=OAuth.getParameterMap(e.parameters);null==r.oauth_consumer_key&&OAuth.setParameter(e,"oauth_consumer_key",t.consumerKey||""),null==r.oauth_token&&null!=t.token&&OAuth.setParameter(e,"oauth_token",t.token),null==r.oauth_version&&OAuth.setParameter(e,"oauth_version","1.0"),null==r.oauth_timestamp&&OAuth.setParameter(e,"oauth_timestamp",OAuth.timestamp()),null==r.oauth_nonce&&OAuth.setParameter(e,"oauth_nonce",OAuth.nonce(6)),OAuth.SignatureMethod.sign(e,t)},setTimestampAndNonce:function(e){OAuth.setParameter(e,"oauth_timestamp",OAuth.timestamp()),OAuth.setParameter(e,"oauth_nonce",OAuth.nonce(6))},addToURL:function(e,t){if(newURL=e,null!=t){var r=OAuth.formEncode(t);if(r.length>0){var n=e.indexOf("?");newURL+=0>n?"?":"&",newURL+=r}}return newURL},getAuthorizationHeader:function(e,t){for(var r='OAuth realm="'+OAuth.percentEncode(e)+'"',n=OAuth.getParameterList(t),a=0;a<n.length;++a){var u=n[a],o=u[0];0==o.indexOf("oauth_")&&(r+=","+OAuth.percentEncode(o)+'="'+OAuth.percentEncode(u[1])+'"')}return r},correctTimestampFromSrc:function(e){e=e||"oauth_timestamp";var t=document.getElementsByTagName("script");if(null!=t&&t.length){var r=t[t.length-1].src;if(r){var n=r.indexOf("?");if(!(0>n)){parameters=OAuth.getParameterMap(OAuth.decodeForm(r.substring(n+1)));var a=parameters[e];null!=a&&OAuth.correctTimestamp(a)}}}},correctTimestamp:function(e){OAuth.timeCorrectionMsec=1e3*e-(new Date).getTime()},timeCorrectionMsec:0,timestamp:function(){var e=(new Date).getTime()+OAuth.timeCorrectionMsec;return Math.floor(e/1e3)},nonce:function(e){for(var t=OAuth.nonce.CHARS,r="",n=0;e>n;++n){var a=Math.floor(Math.random()*t.length);r+=t.substring(a,a+1)}return r}}),OAuth.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",OAuth.declareClass=function(e,t,r){var n=e[t];if(e[t]=r,null!=r&&null!=n)for(var a in n)"prototype"!=a&&(r[a]=n[a]);return r},OAuth.declareClass(OAuth,"SignatureMethod",function(){}),OAuth.setProperties(OAuth.SignatureMethod.prototype,{sign:function(e){var t=OAuth.SignatureMethod.getBaseString(e),r=this.getSignature(t);return OAuth.setParameter(e,"oauth_signature",r),r},initialize:function(e,t){var r;r=null!=t.accessorSecret&&e.length>9&&"-Accessor"==e.substring(e.length-9)?t.accessorSecret:t.consumerSecret,this.key=OAuth.percentEncode(r)+"&"+OAuth.percentEncode(t.tokenSecret)}}),OAuth.setProperties(OAuth.SignatureMethod,{sign:function(e,t){var r=OAuth.getParameterMap(e.parameters).oauth_signature_method;(null==r||""==r)&&(r="HMAC-SHA1",OAuth.setParameter(e,"oauth_signature_method",r)),OAuth.SignatureMethod.newMethod(r,t).sign(e)},newMethod:function(e,t){var r=OAuth.SignatureMethod.REGISTERED[e];if(null!=r){var n=new r;return n.initialize(e,t),n}var a=new Error("signature_method_rejected"),u="";for(var o in OAuth.SignatureMethod.REGISTERED)""!=u&&(u+="&"),u+=OAuth.percentEncode(o);throw a.oauth_acceptable_signature_methods=u,a},REGISTERED:{},registerMethodClass:function(e,t){for(var r=0;r<e.length;++r)OAuth.SignatureMethod.REGISTERED[e[r]]=t},makeSubclass:function(e){var t=OAuth.SignatureMethod,r=function(){t.call(this)};return r.prototype=new t,r.prototype.getSignature=e,r.prototype.constructor=r,r},getBaseString:function(e){var t,r=e.action,n=r.indexOf("?");if(0>n)t=e.parameters;else{t=OAuth.decodeForm(r.substring(n+1));for(var a=OAuth.getParameterList(e.parameters),u=0;u<a.length;++u)t.push(a[u])}return OAuth.percentEncode(e.method.toUpperCase())+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeUrl(r))+"&"+OAuth.percentEncode(OAuth.SignatureMethod.normalizeParameters(t))},normalizeUrl:function(e){var t=OAuth.SignatureMethod.parseUri(e),r=t.protocol.toLowerCase(),n=t.authority.toLowerCase(),a="http"==r&&80==t.port||"https"==r&&443==t.port;if(a){var u=n.lastIndexOf(":");u>=0&&(n=n.substring(0,u))}var o=t.path;return o||(o="/"),r+"://"+n+o},parseUri:function(e){for(var t={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=t.parser.strict.exec(e),n={},a=14;a--;)n[t.key[a]]=r[a]||"";return n},normalizeParameters:function(e){if(null==e)return"";for(var t=OAuth.getParameterList(e),r=[],n=0;n<t.length;++n){var a=t[n];"oauth_signature"!=a[0]&&r.push([OAuth.percentEncode(a[0])+" "+OAuth.percentEncode(a[1]),a])}r.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0});for(var u=[],o=0;o<r.length;++o)u.push(r[o][1]);return OAuth.formEncode(u)}}),OAuth.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],OAuth.SignatureMethod.makeSubclass(function(){return this.key})),OAuth.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],OAuth.SignatureMethod.makeSubclass(function(e){b64pad="=";var t=b64_hmac_sha1(this.key,e);return t}));try{OAuth.correctTimestampFromSrc()}catch(e){}
angular.module("2l-oauth",[]).provider("oauth2l",function(){var e={};e.setKeys=function(e,t){this.ck=e,this.cks=t},e.makeSignedRequest=function(e,t,r){var a,n,s;1==arguments.length?this.ck&&this.cks?(s=arguments[0],a=this.ck,n=this.cks):console.error("makeSignedRequest needs 3 args if you don't use setKeys"):3==arguments.length?(a=e,n=t,s=r):console.error("makeSignedRequest invalid arguments number");var o={consumerSecret:n,tokenSecret:""},u={action:s,method:"GET",parameters:[["oauth_version","1.0"],["oauth_consumer_key",a]]};OAuth.setTimestampAndNonce(u),OAuth.SignatureMethod.sign(u,o);var i=OAuth.getParameterMap(u),h=OAuth.decodeForm(OAuth.SignatureMethod.getBaseString(u)),m="";if(i.parameters)for(var c in i.parameters)for(var g in i.parameters[c])if("oauth_signature"==i.parameters[c][g]){m=i.parameters[c][1];break}var d=h[2][0].split("&");d.push("oauth_signature="+encodeURIComponent(m)),d.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:e[1]<t[1]?-1:e[1]>t[1]?1:0});var v="";for(var k in d)v+=d[k]+"&";var l=h[1][0]+"?"+v.slice(0,v.length-1);return l},this.$get=[function(){return e}]});